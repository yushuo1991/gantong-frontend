# 感统训练中心 Nginx配置文件
# 部署在独立目录，不影响其他项目

server {
    listen 80;
    server_name gantong.yushuo.click;
    
    # 网站根目录
    root /www/wwwroot/gantong;
    index index.html;
    
    # 日志文件
    access_log /www/wwwlogs/gantong_access.log;
    error_log /www/wwwlogs/gantong_error.log;
    
    # 字符集
    charset utf-8;
    
    # Gzip压缩
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml text/javascript;
    gzip_vary on;
    
    # 主配置 - 支持HTML5路由
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # HTML文件配置 - 禁用缓存以便实时更新
    location ~ \.html$ {
        add_header Cache-Control "no-cache, must-revalidate";
        expires -1;
    }
    
    # 静态资源缓存（如果将来添加图片、CSS、JS）
    location ~* \.(jpg|jpeg|png|gif|ico|css|js)$ {
        expires 7d;
        add_header Cache-Control "public, immutable";
    }
    
    # 禁止访问隐藏文件
    location ~ /\. {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # 禁止访问备份文件
    location ~ ~$ {
        deny all;
        access_log off;
        log_not_found off;
    }
    
    # 安全头部
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
}

# 如果需要使用子路径而非子域名，使用以下配置：
# location /gantong {
#     alias /www/wwwroot/gantong;
#     index index.html;
#     
#     location ~ \.html$ {
#         add_header Cache-Control "no-cache, must-revalidate";
#     }
#     
#     try_files $uri $uri/ /gantong/index.html;
# }

